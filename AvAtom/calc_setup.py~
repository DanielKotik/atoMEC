# import standard packages

# import external packages
import numpy as np
from mendeleev import element
from math import pi

# import internal packages
import unit_conv
import constants

class BuildAtom:
    '''
    Initializes the atom to be used in all calculations
    
    Mandatory inputs:
    - species (str)    : atomic species 
    - temp (float)     : system temperature in eV
    - density (float)  : material density (in g cm^-3)
    Optional inputs:
    - charge (int)     : net charge
    '''

    def __init__(self,species,density,temp,charge=0):

        # Input variables
        self.species = species
        self.temp    = temp
        self.charge  = charge
        self.density = density

        # Fundamental atomic properties
        self.at_chrg = element(species).atomic_number # atomic number
        self.at_mass = element(species).atomic_weight # atomic mass
        self.nele = self.at_chrg + self.charge
        
        # Compute the radius and volume of average atom model

        # compute atomic mass in g
        mass_g = constants.mp_g*self.at_mass
        # compute volume and radius in cm^3/cm
        vol_cm = mass_g/self.density
        rad_cm = (3.*vol_cm/4.*pi)**(1./3.)
        # Convert to a.u.
        self.radius = unit_conv.cm_to_bohr(rad_cm)
        self.volume = (4.*pi*self.radius**3.)/3.
